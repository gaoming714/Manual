import{f as W,u as Z,g as T,h as ee,P as ae,t as le,i as te,j as C,k,l,m as se,n as $,p as re,R as I,q as ue,s as ie,v as ne,x as oe,y as ce,z as F,A as P,C as he,B as ve,D as me,E as de,F as pe,G as ye,H as ge,I as B,J as be,K as R}from"./app-CFwVIVLe.js";const fe=["/","/support.html","/delta/PATH.html","/delta/","/delta/sidebar.html","/sigma/HEXO_travis%20CI.html","/lambda/Alpha_fullstack.html","/lambda/Alpha_nodejs.html","/lambda/Alpha_python.html","/lambda/Alpha_shell.html","/lambda/Git_config.html","/lambda/Git_guide.html","/lambda/Git_server.html","/lambda/Git_webhook.html","/lambda/Install_linux_suse.html","/lambda/Install_msys2.html","/lambda/Install_server_debian.html","/lambda/Packages.html","/lambda/gunicorn.html","/lambda/jupyter_server.html","/lambda/logging_python.html","/lambda/mysql.html","/lambda/nginx.html","/lambda/olive_config.html","/lambda/python_portable.html","/lambda/selenium.html","/lambda/sublime.html","/lambda/systemctl.html","/lambda/vim.html","/zeta/DNS.html","/zeta/Install_windows_10.html","/zeta/Linux_Label.html","/zeta/excel%20%E7%A0%B4%E8%A7%A3%E4%BF%9D%E6%8A%A4%E6%96%87%E6%A1%A3%E5%AE%8F%E4%BB%A3%E7%A0%81.html","/zh-cn/coverpage.html","/zh-cn/navbar.html","/zh-cn/sidebar.html","/delta/msys64_build/root/","/404.html","/sigma/","/lambda/","/zeta/","/zh-cn/","/delta/msys64_build/"],_e="SEARCH_PRO_QUERY_HISTORY",y=B(_e,[]),He=()=>{const{queryHistoryCount:s}=R;return{enabled:s>0,queryHistory:y,addQueryHistory:i=>{y.value=Array.from(new Set([i,...y.value.slice(0,s-1)]))},removeQueryHistory:i=>{y.value=[...y.value.slice(0,i),...y.value.slice(i+1)]}}},S=s=>fe[s.id]+("anchor"in s?`#${s.anchor}`:""),Ae="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:j}=R,g=B(Ae,[]),ke=()=>({enabled:j>0,resultHistory:g,addResultHistory:r=>{{const i={link:S(r),display:r.display};"header"in r&&(i.header=r.header),g.value=[i,...g.value.slice(0,j-1)]}},removeResultHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}),Re=s=>{const r=he(),i=T(),w=ve(),n=C(0),b=k(()=>n.value>0),v=me([]);return de(()=>{const{search:x,terminate:m}=pe(),f=ye(p=>{const _=p.join(" "),{searchFilter:d=t=>t,splitWord:D,suggestionsFilter:u,...o}=r.value;_?(n.value+=1,x(p.join(" "),i.value,o).then(t=>d(t,_,i.value,w.value)).then(t=>{n.value-=1,v.value=t}).catch(t=>{console.warn(t),n.value-=1,n.value||(v.value=[])})):v.value=[]},R.searchDelay-R.suggestDelay);$([s,i],([p])=>f(p),{immediate:!0}),ge(()=>{m()})}),{isSearching:b,results:v}};var xe=W({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(s,{emit:r}){const i=Z(),w=T(),n=ee(ae),{addQueryHistory:b,queryHistory:v,removeQueryHistory:x}=He(),{resultHistory:m,addResultHistory:f,removeResultHistory:p}=ke(),_=le(s,"queries"),{results:d,isSearching:D}=Re(_),u=te({isQuery:!0,index:0}),o=C(0),t=C(0),L=k(()=>v.value.length>0||m.value.length>0),E=k(()=>d.value.length>0),Q=k(()=>d.value[o.value]||null),O=()=>{const{isQuery:e,index:a}=u;a===0?(u.isQuery=!e,u.index=e?m.value.length-1:v.value.length-1):u.index=a-1},G=()=>{const{isQuery:e,index:a}=u;a===(e?v.value.length-1:m.value.length-1)?(u.isQuery=!e,u.index=0):u.index=a+1},U=()=>{o.value=o.value>0?o.value-1:d.value.length-1,t.value=Q.value.contents.length-1},Y=()=>{o.value=o.value<d.value.length-1?o.value+1:0,t.value=0},M=()=>{t.value<Q.value.contents.length-1?t.value+=1:Y()},J=()=>{t.value>0?t.value-=1:U()},q=e=>e.map(a=>be(a)?a:l(a[0],a[1])),K=e=>{if(e.type==="customField"){const a=oe[e.index]||"$content",[c,A=""]=ce(a)?a[w.value].split("$content"):a.split("$content");return e.display.map(h=>l("div",q([c,...h,A])))}return e.display.map(a=>l("div",q(a)))},H=()=>{o.value=0,t.value=0,r("updateQuery",""),r("close")},N=()=>l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},n.value.queryHistory),v.value.map((e,a)=>l("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===a}],onClick:()=>{r("updateQuery",e)}},[l(F,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},e),l("button",{class:"search-pro-remove-icon",innerHTML:P,onClick:c=>{c.preventDefault(),c.stopPropagation(),x(a)}})]))])),V=()=>l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},n.value.resultHistory),m.value.map((e,a)=>l(I,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===a}],onClick:()=>{H()}},()=>[l(F,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(c=>q(c)).flat())]),l("button",{class:"search-pro-remove-icon",innerHTML:P,onClick:c=>{c.preventDefault(),c.stopPropagation(),p(a)}})]))]));return se("keydown",e=>{if(s.isFocusing){if(E.value){if(e.key==="ArrowUp")J();else if(e.key==="ArrowDown")M();else if(e.key==="Enter"){const a=Q.value.contents[t.value];b(s.queries.join(" ")),f(a),i.push(S(a)),H()}}else if(e.key==="ArrowUp")O();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:a}=u;u.isQuery?(r("updateQuery",v.value[a]),e.preventDefault()):(i.push(m.value[a].link),H())}}}),$([o,t],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["search-pro-result-wrapper",{empty:s.queries.length?!E.value:!L.value}],id:"search-pro-results"},s.queries.length?D.value?l(re,{hint:n.value.searching}):E.value?l("ul",{class:"search-pro-result-list"},d.value.map(({title:e,contents:a},c)=>{const A=o.value===c;return l("li",{class:["search-pro-result-list-item",{active:A}]},[l("div",{class:"search-pro-result-title"},e||n.value.defaultTitle),a.map((h,X)=>{const z=A&&t.value===X;return l(I,{to:S(h),class:["search-pro-result-item",{active:z,"aria-selected":z}],onClick:()=>{b(s.queries.join(" ")),f(h),H()}},()=>[h.type==="text"?null:l(h.type==="title"?ue:h.type==="heading"?ie:ne,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[h.type==="text"&&h.header?l("div",{class:"content-header"},h.header):null,l("div",K(h))])])})])})):n.value.emptyResult:L.value?[N(),V()]:n.value.emptyHistory)}});export{xe as default};
