import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as i,o as e}from"./app-CFwVIVLe.js";const p={};function l(r,s){return e(),a("div",null,s[0]||(s[0]=[i(`<h1 id="破解保护密码的excel文件" tabindex="-1"><a class="header-anchor" href="#破解保护密码的excel文件"><span>破解保护密码的Excel文件</span></a></h1><p>录制宏 alt+F11 ， 插入模块(可选)</p><p>1.打开您需要破解保护密码的Excel文件；<br> 2.依次点击菜单栏上的工具---宏----录制新宏，输入宏名字如:aa；<br> 3.停止录制(这样得到一个空宏)；<br> 4.依次点击菜单栏上的工具---宏----宏,选aa,点编辑按钮；<br> 5.删除窗口中的所有字符(只有几个),替换为下面的内容；</p><p>宏代码：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span></span></span>
<span class="line"><span>Option Explicit</span></span>
<span class="line"><span>Public Sub AllInternalPasswords()</span></span>
<span class="line"><span>&#39; Breaks worksheet and workbook structure passwords. Bob McCormick</span></span>
<span class="line"><span>&#39; probably originator of base code algorithm modified for coverage</span></span>
<span class="line"><span>&#39; of workbook structure / windows passwords and for multiple passwords</span></span>
<span class="line"><span>&#39;</span></span>
<span class="line"><span>&#39; Norman Harker and JE McGimpsey 27-Dec-2002 (Version 1.1)</span></span>
<span class="line"><span>&#39; Modified 2003-Apr-04 by JEM: All msgs to constants, and</span></span>
<span class="line"><span>&#39; eliminate one Exit Sub (Version 1.1.1)</span></span>
<span class="line"><span>&#39; Reveals hashed passwords NOT original passwords</span></span>
<span class="line"><span>Const DBLSPACE As String = vbNewLine &amp; vbNewLine</span></span>
<span class="line"><span>Const AUTHORS As String = DBLSPACE &amp; vbNewLine &amp; _</span></span>
<span class="line"><span>&quot;Adapted from Bob McCormick base code by&quot; &amp; _</span></span>
<span class="line"><span>&quot;Norman Harker and JE McGimpsey&quot;</span></span>
<span class="line"><span>Const HEADER As String = &quot;AllInternalPasswords User Message&quot;</span></span>
<span class="line"><span>Const VERSION As String = DBLSPACE &amp; &quot;Version 1.1.1 2003-Apr-04&quot;</span></span>
<span class="line"><span>Const REPBACK As String = DBLSPACE &amp; &quot;Please report failure &quot; &amp; _</span></span>
<span class="line"><span>&quot;to the microsoft.public.excel.programming newsgroup.&quot;</span></span>
<span class="line"><span>Const ALLCLEAR As String = DBLSPACE &amp; &quot;The workbook should &quot; &amp; _</span></span>
<span class="line"><span>&quot;now be free of all password protection, so make sure you:&quot; &amp; _</span></span>
<span class="line"><span>DBLSPACE &amp; &quot;SAVE IT NOW!&quot; &amp; DBLSPACE &amp; &quot;and also&quot; &amp; _</span></span>
<span class="line"><span>DBLSPACE &amp; &quot;BACKUP!, BACKUP!!, BACKUP!!!&quot; &amp; _</span></span>
<span class="line"><span>DBLSPACE &amp; &quot;Also, remember that the password was &quot; &amp; _</span></span>
<span class="line"><span>&quot;put there for a reason. Don&#39;t stuff up crucial formulas &quot; &amp; _</span></span>
<span class="line"><span>&quot;or data.&quot; &amp; DBLSPACE &amp; &quot;Access and use of some data &quot; &amp; _</span></span>
<span class="line"><span>&quot;may be an offense. If in doubt, don&#39;t.&quot;</span></span>
<span class="line"><span>Const MSGNOPWORDS1 As String = &quot;There were no passwords on &quot; &amp; _</span></span>
<span class="line"><span>&quot;sheets, or workbook structure or windows.&quot; &amp; AUTHORS &amp; VERSION</span></span>
<span class="line"><span>Const MSGNOPWORDS2 As String = &quot;There was no protection to &quot; &amp; _</span></span>
<span class="line"><span>&quot;workbook structure or windows.&quot; &amp; DBLSPACE &amp; _</span></span>
<span class="line"><span>&quot;Proceeding to unprotect sheets.&quot; &amp; AUTHORS &amp; VERSION</span></span>
<span class="line"><span>Const MSGTAKETIME As String = &quot;After pressing OK button this &quot; &amp; _</span></span>
<span class="line"><span>&quot;will take some time.&quot; &amp; DBLSPACE &amp; &quot;Amount of time &quot; &amp; _</span></span>
<span class="line"><span>&quot;depends on how many different passwords, the &quot; &amp; _</span></span>
<span class="line"><span>&quot;passwords, and your computer&#39;s specification.&quot; &amp; DBLSPACE &amp; _</span></span>
<span class="line"><span>&quot;Just be patient! Make me a coffee!&quot; &amp; AUTHORS &amp; VERSION</span></span>
<span class="line"><span>Const MSGPWORDFOUND1 As String = &quot;You had a Worksheet &quot; &amp; _</span></span>
<span class="line"><span>&quot;Structure or Windows Password set.&quot; &amp; DBLSPACE &amp; _</span></span>
<span class="line"><span>&quot;The password found was: &quot; &amp; DBLSPACE &amp; &quot;$$&quot; &amp; DBLSPACE &amp; _</span></span>
<span class="line"><span>&quot;Note it down for potential future use in other workbooks by &quot; &amp; _</span></span>
<span class="line"><span>&quot;the same person who set this password.&quot; &amp; DBLSPACE &amp; _</span></span>
<span class="line"><span>&quot;Now to check and clear other passwords.&quot; &amp; AUTHORS &amp; VERSION</span></span>
<span class="line"><span>Const MSGPWORDFOUND2 As String = &quot;You had a Worksheet &quot; &amp; _</span></span>
<span class="line"><span>&quot;password set.&quot; &amp; DBLSPACE &amp; &quot;The password found was: &quot; &amp; _</span></span>
<span class="line"><span>DBLSPACE &amp; &quot;$$&quot; &amp; DBLSPACE &amp; &quot;Note it down for potential &quot; &amp; _</span></span>
<span class="line"><span>&quot;future use in other workbooks by same person who &quot; &amp; _</span></span>
<span class="line"><span>&quot;set this password.&quot; &amp; DBLSPACE &amp; &quot;Now to check and clear &quot; &amp; _</span></span>
<span class="line"><span>&quot;other passwords.&quot; &amp; AUTHORS &amp; VERSION</span></span>
<span class="line"><span>Const MSGONLYONE As String = &quot;Only structure / windows &quot; &amp; _</span></span>
<span class="line"><span>&quot;protected with the password that was just found.&quot; &amp; _</span></span>
<span class="line"><span>ALLCLEAR &amp; AUTHORS &amp; VERSION &amp; REPBACK</span></span>
<span class="line"><span>Dim w1 As Worksheet, w2 As Worksheet</span></span>
<span class="line"><span>Dim i As Integer, j As Integer, k As Integer, l As Integer</span></span>
<span class="line"><span>Dim m As Integer, n As Integer, i1 As Integer, i2 As Integer</span></span>
<span class="line"><span>Dim i3 As Integer, i4 As Integer, i5 As Integer, i6 As Integer</span></span>
<span class="line"><span>Dim PWord1 As String</span></span>
<span class="line"><span>Dim ShTag As Boolean, WinTag As Boolean</span></span>
<span class="line"><span>Application.ScreenUpdating = False</span></span>
<span class="line"><span>With ActiveWorkbook</span></span>
<span class="line"><span>WinTag = .ProtectStructure Or .ProtectWindows</span></span>
<span class="line"><span>End With</span></span>
<span class="line"><span>ShTag = False</span></span>
<span class="line"><span>For Each w1 In Worksheets</span></span>
<span class="line"><span>ShTag = ShTag Or w1.ProtectContents</span></span>
<span class="line"><span>Next w1</span></span>
<span class="line"><span>If Not ShTag And Not WinTag Then</span></span>
<span class="line"><span>MsgBox MSGNOPWORDS1, vbInformation, HEADER</span></span>
<span class="line"><span>Exit Sub</span></span>
<span class="line"><span>End If</span></span>
<span class="line"><span>MsgBox MSGTAKETIME, vbInformation, HEADER</span></span>
<span class="line"><span>If Not WinTag Then</span></span>
<span class="line"><span>MsgBox MSGNOPWORDS2, vbInformation, HEADER</span></span>
<span class="line"><span>Else</span></span>
<span class="line"><span>On Error Resume Next</span></span>
<span class="line"><span>Do &#39;dummy do loop</span></span>
<span class="line"><span>For i = 65 To 66: For j = 65 To 66: For k = 65 To 66</span></span>
<span class="line"><span>For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66</span></span>
<span class="line"><span>For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66</span></span>
<span class="line"><span>For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126</span></span>
<span class="line"><span>With ActiveWorkbook</span></span>
<span class="line"><span>.Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; _</span></span>
<span class="line"><span>Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; _</span></span>
<span class="line"><span>Chr(i3) &amp; Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span></span>
<span class="line"><span>If .ProtectStructure = False And _</span></span>
<span class="line"><span>.ProtectWindows = False Then</span></span>
<span class="line"><span>PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; _</span></span>
<span class="line"><span>Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _</span></span>
<span class="line"><span>Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span></span>
<span class="line"><span>MsgBox Application.Substitute(MSGPWORDFOUND1, _</span></span>
<span class="line"><span>&quot;$$&quot;, PWord1), vbInformation, HEADER</span></span>
<span class="line"><span>Exit Do &#39;Bypass all for...nexts</span></span>
<span class="line"><span>End If</span></span>
<span class="line"><span>End With</span></span>
<span class="line"><span>Next: Next: Next: Next: Next: Next</span></span>
<span class="line"><span>Next: Next: Next: Next: Next: Next</span></span>
<span class="line"><span>Loop Until True</span></span>
<span class="line"><span>On Error GoTo 0</span></span>
<span class="line"><span>End If</span></span>
<span class="line"><span>If WinTag And Not ShTag Then</span></span>
<span class="line"><span>MsgBox MSGONLYONE, vbInformation, HEADER</span></span>
<span class="line"><span>Exit Sub</span></span>
<span class="line"><span>End If</span></span>
<span class="line"><span>On Error Resume Next</span></span>
<span class="line"><span>For Each w1 In Worksheets</span></span>
<span class="line"><span>&#39;Attempt clearance with PWord1</span></span>
<span class="line"><span>w1.Unprotect PWord1</span></span>
<span class="line"><span>Next w1</span></span>
<span class="line"><span>On Error GoTo 0</span></span>
<span class="line"><span>ShTag = False</span></span>
<span class="line"><span>For Each w1 In Worksheets</span></span>
<span class="line"><span>&#39;Checks for all clear ShTag triggered to 1 if not.</span></span>
<span class="line"><span>ShTag = ShTag Or w1.ProtectContents</span></span>
<span class="line"><span>Next w1</span></span>
<span class="line"><span>If ShTag Then</span></span>
<span class="line"><span>For Each w1 In Worksheets</span></span>
<span class="line"><span>With w1</span></span>
<span class="line"><span>If .ProtectContents Then</span></span>
<span class="line"><span>On Error Resume Next</span></span>
<span class="line"><span>Do &#39;Dummy do loop</span></span>
<span class="line"><span>For i = 65 To 66: For j = 65 To 66: For k = 65 To 66</span></span>
<span class="line"><span>For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66</span></span>
<span class="line"><span>For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66</span></span>
<span class="line"><span>For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126</span></span>
<span class="line"><span>.Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; _</span></span>
<span class="line"><span>Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _</span></span>
<span class="line"><span>Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span></span>
<span class="line"><span>If Not .ProtectContents Then</span></span>
<span class="line"><span>PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; _</span></span>
<span class="line"><span>Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _</span></span>
<span class="line"><span>Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span></span>
<span class="line"><span>MsgBox Application.Substitute(MSGPWORDFOUND2, _</span></span>
<span class="line"><span>&quot;$$&quot;, PWord1), vbInformation, HEADER</span></span>
<span class="line"><span>&#39;leverage finding Pword by trying on other sheets</span></span>
<span class="line"><span>For Each w2 In Worksheets</span></span>
<span class="line"><span>w2.Unprotect PWord1</span></span>
<span class="line"><span>Next w2</span></span>
<span class="line"><span>Exit Do &#39;Bypass all for...nexts</span></span>
<span class="line"><span>End If</span></span>
<span class="line"><span>Next: Next: Next: Next: Next: Next</span></span>
<span class="line"><span>Next: Next: Next: Next: Next: Next</span></span>
<span class="line"><span>Loop Until True</span></span>
<span class="line"><span>On Error GoTo 0</span></span>
<span class="line"><span>End If</span></span>
<span class="line"><span>End With</span></span>
<span class="line"><span>Next w1</span></span>
<span class="line"><span>End If</span></span>
<span class="line"><span>MsgBox ALLCLEAR &amp; AUTHORS &amp; VERSION &amp; REPBACK, vbInformation, HEADER</span></span>
<span class="line"><span>End Sub</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6.关闭编辑窗口；<br> 7.依次点击菜单栏上的工具---宏-----宏,选AllInternalPasswords,运行,确定两次；</p><h2 id="等一会-有1-2分钟-就会出现一个对话框" tabindex="-1"><a class="header-anchor" href="#等一会-有1-2分钟-就会出现一个对话框"><span>等一会(有1~2分钟),就会出现一个对话框</span></a></h2>`,7)]))}const c=n(p,[["render",l]]),t=JSON.parse(`{"path":"/zeta/excel%20%E7%A0%B4%E8%A7%A3%E4%BF%9D%E6%8A%A4%E6%96%87%E6%A1%A3%E5%AE%8F%E4%BB%A3%E7%A0%81.html","title":"破解保护密码的Excel文件","lang":"en-US","frontmatter":{"description":"破解保护密码的Excel文件 录制宏 alt+F11 ， 插入模块(可选) 1.打开您需要破解保护密码的Excel文件； 2.依次点击菜单栏上的工具---宏----录制新宏，输入宏名字如:aa； 3.停止录制(这样得到一个空宏)； 4.依次点击菜单栏上的工具---宏----宏,选aa,点编辑按钮； 5.删除窗口中的所有字符(只有几个),替换为下面的内容...","head":[["meta",{"property":"og:url","content":"http://xinxi.jokerpy.top/zeta/excel%20%E7%A0%B4%E8%A7%A3%E4%BF%9D%E6%8A%A4%E6%96%87%E6%A1%A3%E5%AE%8F%E4%BB%A3%E7%A0%81.html"}],["meta",{"property":"og:site_name","content":"HoneyPot"}],["meta",{"property":"og:title","content":"破解保护密码的Excel文件"}],["meta",{"property":"og:description","content":"破解保护密码的Excel文件 录制宏 alt+F11 ， 插入模块(可选) 1.打开您需要破解保护密码的Excel文件； 2.依次点击菜单栏上的工具---宏----录制新宏，输入宏名字如:aa； 3.停止录制(这样得到一个空宏)； 4.依次点击菜单栏上的工具---宏----宏,选aa,点编辑按钮； 5.删除窗口中的所有字符(只有几个),替换为下面的内容..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-07-03T08:57:56.000Z"}],["meta",{"property":"article:modified_time","content":"2024-07-03T08:57:56.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"破解保护密码的Excel文件\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-07-03T08:57:56.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"gaoming714\\",\\"url\\":\\"https://github.com/gaoming714\\"}]}"]]},"headers":[{"level":2,"title":"等一会(有1~2分钟),就会出现一个对话框","slug":"等一会-有1-2分钟-就会出现一个对话框","link":"#等一会-有1-2分钟-就会出现一个对话框","children":[]}],"git":{"createdTime":1519815941000,"updatedTime":1719997076000,"contributors":[{"name":"gaoming714","email":"gaoming714@outlook.com","commits":1}]},"readingTime":{"minutes":3.7,"words":1110},"filePathRelative":"zeta/excel 破解保护文档宏代码.md","localizedDate":"February 28, 2018","autoDesc":true,"excerpt":"\\n<p>录制宏  alt+F11 ， 插入模块(可选)</p>\\n<p>1.打开您需要破解保护密码的Excel文件；<br>\\n2.依次点击菜单栏上的工具---宏----录制新宏，输入宏名字如:aa；<br>\\n3.停止录制(这样得到一个空宏)；<br>\\n4.依次点击菜单栏上的工具---宏----宏,选aa,点编辑按钮；<br>\\n5.删除窗口中的所有字符(只有几个),替换为下面的内容；</p>\\n<p>宏代码：</p>\\n<div class=\\"language- line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"\\" data-title=\\"\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span></span></span>\\n<span class=\\"line\\"><span>Option Explicit</span></span>\\n<span class=\\"line\\"><span>Public Sub AllInternalPasswords()</span></span>\\n<span class=\\"line\\"><span>' Breaks worksheet and workbook structure passwords. Bob McCormick</span></span>\\n<span class=\\"line\\"><span>' probably originator of base code algorithm modified for coverage</span></span>\\n<span class=\\"line\\"><span>' of workbook structure / windows passwords and for multiple passwords</span></span>\\n<span class=\\"line\\"><span>'</span></span>\\n<span class=\\"line\\"><span>' Norman Harker and JE McGimpsey 27-Dec-2002 (Version 1.1)</span></span>\\n<span class=\\"line\\"><span>' Modified 2003-Apr-04 by JEM: All msgs to constants, and</span></span>\\n<span class=\\"line\\"><span>' eliminate one Exit Sub (Version 1.1.1)</span></span>\\n<span class=\\"line\\"><span>' Reveals hashed passwords NOT original passwords</span></span>\\n<span class=\\"line\\"><span>Const DBLSPACE As String = vbNewLine &amp; vbNewLine</span></span>\\n<span class=\\"line\\"><span>Const AUTHORS As String = DBLSPACE &amp; vbNewLine &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"Adapted from Bob McCormick base code by\\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"Norman Harker and JE McGimpsey\\"</span></span>\\n<span class=\\"line\\"><span>Const HEADER As String = \\"AllInternalPasswords User Message\\"</span></span>\\n<span class=\\"line\\"><span>Const VERSION As String = DBLSPACE &amp; \\"Version 1.1.1 2003-Apr-04\\"</span></span>\\n<span class=\\"line\\"><span>Const REPBACK As String = DBLSPACE &amp; \\"Please report failure \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"to the microsoft.public.excel.programming newsgroup.\\"</span></span>\\n<span class=\\"line\\"><span>Const ALLCLEAR As String = DBLSPACE &amp; \\"The workbook should \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"now be free of all password protection, so make sure you:\\" &amp; _</span></span>\\n<span class=\\"line\\"><span>DBLSPACE &amp; \\"SAVE IT NOW!\\" &amp; DBLSPACE &amp; \\"and also\\" &amp; _</span></span>\\n<span class=\\"line\\"><span>DBLSPACE &amp; \\"BACKUP!, BACKUP!!, BACKUP!!!\\" &amp; _</span></span>\\n<span class=\\"line\\"><span>DBLSPACE &amp; \\"Also, remember that the password was \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"put there for a reason. Don't stuff up crucial formulas \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"or data.\\" &amp; DBLSPACE &amp; \\"Access and use of some data \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"may be an offense. If in doubt, don't.\\"</span></span>\\n<span class=\\"line\\"><span>Const MSGNOPWORDS1 As String = \\"There were no passwords on \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"sheets, or workbook structure or windows.\\" &amp; AUTHORS &amp; VERSION</span></span>\\n<span class=\\"line\\"><span>Const MSGNOPWORDS2 As String = \\"There was no protection to \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"workbook structure or windows.\\" &amp; DBLSPACE &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"Proceeding to unprotect sheets.\\" &amp; AUTHORS &amp; VERSION</span></span>\\n<span class=\\"line\\"><span>Const MSGTAKETIME As String = \\"After pressing OK button this \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"will take some time.\\" &amp; DBLSPACE &amp; \\"Amount of time \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"depends on how many different passwords, the \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"passwords, and your computer's specification.\\" &amp; DBLSPACE &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"Just be patient! Make me a coffee!\\" &amp; AUTHORS &amp; VERSION</span></span>\\n<span class=\\"line\\"><span>Const MSGPWORDFOUND1 As String = \\"You had a Worksheet \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"Structure or Windows Password set.\\" &amp; DBLSPACE &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"The password found was: \\" &amp; DBLSPACE &amp; \\"$$\\" &amp; DBLSPACE &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"Note it down for potential future use in other workbooks by \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"the same person who set this password.\\" &amp; DBLSPACE &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"Now to check and clear other passwords.\\" &amp; AUTHORS &amp; VERSION</span></span>\\n<span class=\\"line\\"><span>Const MSGPWORDFOUND2 As String = \\"You had a Worksheet \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"password set.\\" &amp; DBLSPACE &amp; \\"The password found was: \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>DBLSPACE &amp; \\"$$\\" &amp; DBLSPACE &amp; \\"Note it down for potential \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"future use in other workbooks by same person who \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"set this password.\\" &amp; DBLSPACE &amp; \\"Now to check and clear \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"other passwords.\\" &amp; AUTHORS &amp; VERSION</span></span>\\n<span class=\\"line\\"><span>Const MSGONLYONE As String = \\"Only structure / windows \\" &amp; _</span></span>\\n<span class=\\"line\\"><span>\\"protected with the password that was just found.\\" &amp; _</span></span>\\n<span class=\\"line\\"><span>ALLCLEAR &amp; AUTHORS &amp; VERSION &amp; REPBACK</span></span>\\n<span class=\\"line\\"><span>Dim w1 As Worksheet, w2 As Worksheet</span></span>\\n<span class=\\"line\\"><span>Dim i As Integer, j As Integer, k As Integer, l As Integer</span></span>\\n<span class=\\"line\\"><span>Dim m As Integer, n As Integer, i1 As Integer, i2 As Integer</span></span>\\n<span class=\\"line\\"><span>Dim i3 As Integer, i4 As Integer, i5 As Integer, i6 As Integer</span></span>\\n<span class=\\"line\\"><span>Dim PWord1 As String</span></span>\\n<span class=\\"line\\"><span>Dim ShTag As Boolean, WinTag As Boolean</span></span>\\n<span class=\\"line\\"><span>Application.ScreenUpdating = False</span></span>\\n<span class=\\"line\\"><span>With ActiveWorkbook</span></span>\\n<span class=\\"line\\"><span>WinTag = .ProtectStructure Or .ProtectWindows</span></span>\\n<span class=\\"line\\"><span>End With</span></span>\\n<span class=\\"line\\"><span>ShTag = False</span></span>\\n<span class=\\"line\\"><span>For Each w1 In Worksheets</span></span>\\n<span class=\\"line\\"><span>ShTag = ShTag Or w1.ProtectContents</span></span>\\n<span class=\\"line\\"><span>Next w1</span></span>\\n<span class=\\"line\\"><span>If Not ShTag And Not WinTag Then</span></span>\\n<span class=\\"line\\"><span>MsgBox MSGNOPWORDS1, vbInformation, HEADER</span></span>\\n<span class=\\"line\\"><span>Exit Sub</span></span>\\n<span class=\\"line\\"><span>End If</span></span>\\n<span class=\\"line\\"><span>MsgBox MSGTAKETIME, vbInformation, HEADER</span></span>\\n<span class=\\"line\\"><span>If Not WinTag Then</span></span>\\n<span class=\\"line\\"><span>MsgBox MSGNOPWORDS2, vbInformation, HEADER</span></span>\\n<span class=\\"line\\"><span>Else</span></span>\\n<span class=\\"line\\"><span>On Error Resume Next</span></span>\\n<span class=\\"line\\"><span>Do 'dummy do loop</span></span>\\n<span class=\\"line\\"><span>For i = 65 To 66: For j = 65 To 66: For k = 65 To 66</span></span>\\n<span class=\\"line\\"><span>For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66</span></span>\\n<span class=\\"line\\"><span>For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66</span></span>\\n<span class=\\"line\\"><span>For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126</span></span>\\n<span class=\\"line\\"><span>With ActiveWorkbook</span></span>\\n<span class=\\"line\\"><span>.Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; _</span></span>\\n<span class=\\"line\\"><span>Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; _</span></span>\\n<span class=\\"line\\"><span>Chr(i3) &amp; Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span></span>\\n<span class=\\"line\\"><span>If .ProtectStructure = False And _</span></span>\\n<span class=\\"line\\"><span>.ProtectWindows = False Then</span></span>\\n<span class=\\"line\\"><span>PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; _</span></span>\\n<span class=\\"line\\"><span>Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _</span></span>\\n<span class=\\"line\\"><span>Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span></span>\\n<span class=\\"line\\"><span>MsgBox Application.Substitute(MSGPWORDFOUND1, _</span></span>\\n<span class=\\"line\\"><span>\\"$$\\", PWord1), vbInformation, HEADER</span></span>\\n<span class=\\"line\\"><span>Exit Do 'Bypass all for...nexts</span></span>\\n<span class=\\"line\\"><span>End If</span></span>\\n<span class=\\"line\\"><span>End With</span></span>\\n<span class=\\"line\\"><span>Next: Next: Next: Next: Next: Next</span></span>\\n<span class=\\"line\\"><span>Next: Next: Next: Next: Next: Next</span></span>\\n<span class=\\"line\\"><span>Loop Until True</span></span>\\n<span class=\\"line\\"><span>On Error GoTo 0</span></span>\\n<span class=\\"line\\"><span>End If</span></span>\\n<span class=\\"line\\"><span>If WinTag And Not ShTag Then</span></span>\\n<span class=\\"line\\"><span>MsgBox MSGONLYONE, vbInformation, HEADER</span></span>\\n<span class=\\"line\\"><span>Exit Sub</span></span>\\n<span class=\\"line\\"><span>End If</span></span>\\n<span class=\\"line\\"><span>On Error Resume Next</span></span>\\n<span class=\\"line\\"><span>For Each w1 In Worksheets</span></span>\\n<span class=\\"line\\"><span>'Attempt clearance with PWord1</span></span>\\n<span class=\\"line\\"><span>w1.Unprotect PWord1</span></span>\\n<span class=\\"line\\"><span>Next w1</span></span>\\n<span class=\\"line\\"><span>On Error GoTo 0</span></span>\\n<span class=\\"line\\"><span>ShTag = False</span></span>\\n<span class=\\"line\\"><span>For Each w1 In Worksheets</span></span>\\n<span class=\\"line\\"><span>'Checks for all clear ShTag triggered to 1 if not.</span></span>\\n<span class=\\"line\\"><span>ShTag = ShTag Or w1.ProtectContents</span></span>\\n<span class=\\"line\\"><span>Next w1</span></span>\\n<span class=\\"line\\"><span>If ShTag Then</span></span>\\n<span class=\\"line\\"><span>For Each w1 In Worksheets</span></span>\\n<span class=\\"line\\"><span>With w1</span></span>\\n<span class=\\"line\\"><span>If .ProtectContents Then</span></span>\\n<span class=\\"line\\"><span>On Error Resume Next</span></span>\\n<span class=\\"line\\"><span>Do 'Dummy do loop</span></span>\\n<span class=\\"line\\"><span>For i = 65 To 66: For j = 65 To 66: For k = 65 To 66</span></span>\\n<span class=\\"line\\"><span>For l = 65 To 66: For m = 65 To 66: For i1 = 65 To 66</span></span>\\n<span class=\\"line\\"><span>For i2 = 65 To 66: For i3 = 65 To 66: For i4 = 65 To 66</span></span>\\n<span class=\\"line\\"><span>For i5 = 65 To 66: For i6 = 65 To 66: For n = 32 To 126</span></span>\\n<span class=\\"line\\"><span>.Unprotect Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; _</span></span>\\n<span class=\\"line\\"><span>Chr(l) &amp; Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _</span></span>\\n<span class=\\"line\\"><span>Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span></span>\\n<span class=\\"line\\"><span>If Not .ProtectContents Then</span></span>\\n<span class=\\"line\\"><span>PWord1 = Chr(i) &amp; Chr(j) &amp; Chr(k) &amp; Chr(l) &amp; _</span></span>\\n<span class=\\"line\\"><span>Chr(m) &amp; Chr(i1) &amp; Chr(i2) &amp; Chr(i3) &amp; _</span></span>\\n<span class=\\"line\\"><span>Chr(i4) &amp; Chr(i5) &amp; Chr(i6) &amp; Chr(n)</span></span>\\n<span class=\\"line\\"><span>MsgBox Application.Substitute(MSGPWORDFOUND2, _</span></span>\\n<span class=\\"line\\"><span>\\"$$\\", PWord1), vbInformation, HEADER</span></span>\\n<span class=\\"line\\"><span>'leverage finding Pword by trying on other sheets</span></span>\\n<span class=\\"line\\"><span>For Each w2 In Worksheets</span></span>\\n<span class=\\"line\\"><span>w2.Unprotect PWord1</span></span>\\n<span class=\\"line\\"><span>Next w2</span></span>\\n<span class=\\"line\\"><span>Exit Do 'Bypass all for...nexts</span></span>\\n<span class=\\"line\\"><span>End If</span></span>\\n<span class=\\"line\\"><span>Next: Next: Next: Next: Next: Next</span></span>\\n<span class=\\"line\\"><span>Next: Next: Next: Next: Next: Next</span></span>\\n<span class=\\"line\\"><span>Loop Until True</span></span>\\n<span class=\\"line\\"><span>On Error GoTo 0</span></span>\\n<span class=\\"line\\"><span>End If</span></span>\\n<span class=\\"line\\"><span>End With</span></span>\\n<span class=\\"line\\"><span>Next w1</span></span>\\n<span class=\\"line\\"><span>End If</span></span>\\n<span class=\\"line\\"><span>MsgBox ALLCLEAR &amp; AUTHORS &amp; VERSION &amp; REPBACK, vbInformation, HEADER</span></span>\\n<span class=\\"line\\"><span>End Sub</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>"}`);export{c as comp,t as data};
